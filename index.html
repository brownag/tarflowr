<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>High-level Orchestration of targets Pipelines • tarflowr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="High-level Orchestration of targets Pipelines">
<meta name="description" content='Provides a simple, high-level interface for creating and executing targets-based workflows, so users can focus on their specific analysis, not on pipeline orchestration. The philosophy of tarflowr is based on the concept of arbitrary "work units." This package is experimental.'>
<meta property="og:description" content='Provides a simple, high-level interface for creating and executing targets-based workflows, so users can focus on their specific analysis, not on pipeline orchestration. The philosophy of tarflowr is based on the concept of arbitrary "work units." This package is experimental.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tarflowr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/orchestration.html">Orchestration of Targets Pipelines with tarflowr</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/brownag/tarflowr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tarflowr">tarflowr<a class="anchor" aria-label="anchor" href="#tarflowr"></a>
</h1></div>
<!-- badges: start -->

<p><img src="https://i.imgur.com/vl0dkkc.png" alt="tarflowr hexsticker" title="tarflowr hexsticker" width="40%" height="40%" hspace="15" vspace="15" align="right"></p>
<blockquote>
<p>[!NOTE]</p>
<p>This package is <em>experimental</em>. The internals are hacky and subject to change. It is a proof of concept: kicking the tires on a system that can float above the level of a single ‘targets’ pipeline.</p>
</blockquote>
<p>The goal of {tarflowr} (say: “tar flower”) is to provide a simple, high-level interface for creating and executing ‘targets’ pipelines, so users can focus more on their specific analysis, not on pipeline orchestration.</p>
<p>The philosophy is based on the concept of arbitrary “work units.” A {tarflowr} workflow is a {targets} pipeline, but work units within that workflow can be {targets} pipelines themselves: either generated by {tarflowr} or custom-made. This abstraction allows one to develop and test each sub-project independently, and then use {tarflowr} as an “orchestrator” to run and combine sub-projects at scale.</p>
<p>The <code><a href="reference/tarflowr_run.html">tarflowr_run()</a></code> function serves as a high-level interface to the ‘targets’ and ‘crew’ packages. It programmatically generates a <code>_targets.R</code> pipeline file based on user-provided inputs, runs the pipeline, and returns the final result. It is designed to abstract the complexity of setting up a ‘targets’-based workflow for common “map-reduce” or “split-apply-combine” tasks.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of tarflowr like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"brownag/tarflowr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example of calculating a sum of squares in parallel:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/brownag/tarflowr/" class="external-link">tarflowr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">PROJECT_DIR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"_my_first_project"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define the work: a list of numbers</span></span>
<span><span class="va">my_work</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define the processing function to work on one item</span></span>
<span><span class="va">square_a_number</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># define the combine function for the list of results</span></span>
<span><span class="va">sum_all_results</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">results_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">results_list</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># run the workflow</span></span>
<span><span class="va">final_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tarflowr_run.html">tarflowr_run</a></span><span class="op">(</span></span>
<span>  work_units <span class="op">=</span> <span class="va">my_work</span>,</span>
<span>  process_func <span class="op">=</span> <span class="va">square_a_number</span>,</span>
<span>  combine_func <span class="op">=</span> <span class="va">sum_all_results</span>,</span>
<span>  project_dir <span class="op">=</span> <span class="va">PROJECT_DIR</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Creating project directory: '/tmp/RtmppjxsU0/_my_first_project'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Starting tarflowr workflow ──────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; • Project directory: '/tmp/RtmppjxsU0/_my_first_project'</span></span>
<span><span class="co">#&gt; • Number of work units: 10</span></span>
<span><span class="co">#&gt; • Parallel workers: 4</span></span>
<span><span class="co">#&gt; ℹ Executing targets pipeline...</span></span>
<span><span class="co">#&gt; + user_functions_file dispatched</span></span>
<span><span class="co">#&gt; ✔ user_functions_file completed [1ms, 148 B]</span></span>
<span><span class="co">#&gt; + work_units_file dispatched</span></span>
<span><span class="co">#&gt; ✔ work_units_file completed [0ms, 137 B]</span></span>
<span><span class="co">#&gt; + user_functions dispatched</span></span>
<span><span class="co">#&gt; ✔ user_functions completed [0ms, 150 B]</span></span>
<span><span class="co">#&gt; + project_work_units dispatched</span></span>
<span><span class="co">#&gt; ✔ project_work_units completed [0ms, 137 B]</span></span>
<span><span class="co">#&gt; + work_seq dispatched</span></span>
<span><span class="co">#&gt; ✔ work_seq completed [0ms, 99 B]</span></span>
<span><span class="co">#&gt; + processed_unit declared [10 branches]</span></span>
<span><span class="co">#&gt; ✔ processed_unit completed [10s, 514 B]</span></span>
<span><span class="co">#&gt; + my_first_project_result dispatched</span></span>
<span><span class="co">#&gt; ✔ my_first_project_result completed [0ms, 53 B]</span></span>
<span><span class="co">#&gt; ✔ ended pipeline [10.4s, 16 completed, 0 skipped]</span></span>
<span></span>
<span><span class="co"># result is 385</span></span>
<span><span class="va">final_sum</span></span>
<span><span class="co">#&gt; [1] 385</span></span>
<span></span>
<span><span class="co"># see "_my_first_project" for _targets.R file and _targets/ cache.</span></span>
<span></span>
<span><span class="co"># when re-run, we get the result from the cache:</span></span>
<span><span class="va">cached_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tarflowr_run.html">tarflowr_run</a></span><span class="op">(</span></span>
<span>  work_units <span class="op">=</span> <span class="va">my_work</span>,</span>
<span>  process_func <span class="op">=</span> <span class="va">square_a_number</span>,</span>
<span>  combine_func <span class="op">=</span> <span class="va">sum_all_results</span>,</span>
<span>  project_dir <span class="op">=</span> <span class="va">PROJECT_DIR</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4</span>,</span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Starting tarflowr workflow ──────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; • Project directory: '/tmp/RtmppjxsU0/_my_first_project'</span></span>
<span><span class="co">#&gt; • Number of work units: 10</span></span>
<span><span class="co">#&gt; • Parallel workers: 4</span></span>
<span><span class="co">#&gt; ℹ Executing targets pipeline...</span></span>
<span><span class="co">#&gt; + user_functions dispatched</span></span>
<span><span class="co">#&gt; ✔ user_functions completed [1ms, 150 B]</span></span>
<span><span class="co">#&gt; + processed_unit declared [10 branches]</span></span>
<span><span class="co">#&gt; ✔ ended pipeline [234ms, 1 completed, 15 skipped]</span></span>
<span><span class="va">cached_sum</span></span>
<span><span class="co">#&gt; [1] 385</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/brownag/tarflowr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/brownag/tarflowr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tarflowr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Andrew Brown <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4565-533X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://humus.rocks/tarflowr/" class="external-link"><img src="https://img.shields.io/badge/docs-HTML-informational" alt="tarflowr Manual"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Brown.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
